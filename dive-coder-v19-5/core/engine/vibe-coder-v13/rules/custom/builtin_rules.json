[
  {
    "id": "VIBE_REGEX_EVAL_JS",
    "title": "Use of eval() in JS/TS",
    "category": "security",
    "severity": "high",
    "confidence": 90,
    "file_globs": [
      "**/*.js",
      "**/*.jsx",
      "**/*.ts",
      "**/*.tsx"
    ],
    "regex": "\\beval\\s*\\(",
    "description": "Dynamic code execution in JS/TS can lead to code injection and XSS if fed with untrusted input.",
    "recommendation": "Avoid eval(); use safe parsers or explicit dispatch. If unavoidable, strictly validate/sanitize input.",
    "cwe": "CWE-95",
    "owasp": "A03:2021-Injection"
  },
  {
    "id": "VIBE_REGEX_REACT_DANGEROUS_HTML",
    "title": "React dangerouslySetInnerHTML usage",
    "category": "security",
    "severity": "high",
    "confidence": 90,
    "file_globs": [
      "**/*.jsx",
      "**/*.tsx"
    ],
    "regex": "\\bdangerouslySetInnerHTML\\b",
    "description": "dangerouslySetInnerHTML can introduce XSS if the HTML content isn't strictly sanitized.",
    "recommendation": "Only use with trusted HTML. If content can be user-controlled, sanitize (e.g., DOMPurify) and add tests for injection vectors.",
    "cwe": "CWE-79",
    "owasp": "A03:2021-Injection"
  },
  {
    "id": "VIBE_REGEX_DEBUGGER",
    "title": "Leftover debugger statement",
    "category": "style",
    "severity": "low",
    "confidence": 85,
    "file_globs": [
      "**/*.js",
      "**/*.jsx",
      "**/*.ts",
      "**/*.tsx"
    ],
    "regex": "\\bdebugger;",
    "description": "Debug statements can ship to production and create performance/UX issues.",
    "recommendation": "Remove debugger statements before shipping.",
    "cwe": null,
    "owasp": null
  },
  {
    "id": "VIBE_REGEX_CONSOLE_LOG",
    "title": "Leftover console.* logging",
    "category": "style",
    "severity": "low",
    "confidence": 85,
    "file_globs": [
      "**/*.js",
      "**/*.jsx",
      "**/*.ts",
      "**/*.tsx"
    ],
    "regex": "\\bconsole\\.(log|debug|info|warn|error)\\s*\\(",
    "description": "Console logging can leak sensitive data and add noise in production logs.",
    "recommendation": "Replace with structured logger (pino/winston) and ensure logs are scrubbed for PII/secrets.",
    "cwe": null,
    "owasp": null
  },
  {
    "id": "VIBE_REGEX_TYPESCRIPT_ANY",
    "title": "TypeScript any usage",
    "category": "architecture",
    "severity": "low",
    "confidence": 80,
    "file_globs": [
      "**/*.ts",
      "**/*.tsx"
    ],
    "regex": "(:\\s*any\\b|\\bas\\s+any\\b)",
    "description": "Using any weakens type safety and often hides design issues.",
    "recommendation": "Replace any with specific types, generics, or unknown + type guards.",
    "cwe": null,
    "owasp": null
  },
  {
    "id": "VIBE_REGEX_TS_IGNORE",
    "title": "TypeScript error suppression (@ts-ignore / @ts-expect-error)",
    "category": "docs",
    "severity": "low",
    "confidence": 85,
    "file_globs": [
      "**/*.ts",
      "**/*.tsx"
    ],
    "regex": "//\\s*@ts-(ignore|expect-error)",
    "description": "Suppressing TypeScript errors can mask real bugs and regressions.",
    "recommendation": "Prefer fixing types; if suppression is necessary, explain why and add a test.",
    "cwe": null,
    "owasp": null
  },
  {
    "id": "VIBE_REGEX_ESLINT_DISABLE",
    "title": "ESLint rule disabled",
    "category": "style",
    "severity": "info",
    "confidence": 80,
    "file_globs": [
      "**/*.js",
      "**/*.jsx",
      "**/*.ts",
      "**/*.tsx"
    ],
    "regex": "eslint-disable",
    "description": "Disabling lint rules may hide issues.",
    "recommendation": "Avoid blanket disables; scope to a single line and document the rationale.",
    "cwe": null,
    "owasp": null
  },
  {
    "id": "VIBE_REGEX_HARDCODED_SECRET",
    "title": "Possible hardcoded secret/password",
    "category": "security",
    "severity": "high",
    "confidence": 80,
    "file_globs": [
      "**/*.py",
      "**/*.js",
      "**/*.ts",
      "**/*.env",
      "**/*.yaml",
      "**/*.yml"
    ],
    "regex": "(?i)(password|passwd|pwd|secret|api[_-]?key)\\s*[:=]\\s*['\\\"][^'\\\"]{6,}['\\\"]",
    "description": "Hardcoded credentials increase risk of credential leakage and compromise.",
    "recommendation": "Move secrets to environment variables / secret manager; rotate exposed secrets.",
    "cwe": "CWE-798",
    "owasp": "A02:2021-Cryptographic Failures"
  },
  {
    "id": "VIBE_REGEX_PY_PRINT",
    "title": "Python print() debug",
    "category": "style",
    "severity": "low",
    "confidence": 80,
    "file_globs": [
      "**/*.py"
    ],
    "regex": "\\bprint\\s*\\(",
    "description": "print() in production code is usually noise and may leak sensitive information.",
    "recommendation": "Replace with structured logger and ensure log levels are configured.",
    "cwe": null,
    "owasp": null
  },
  {
    "id": "VIBE_REGEX_TODO_FIXME",
    "title": "TODO/FIXME marker",
    "category": "docs",
    "severity": "info",
    "confidence": 80,
    "file_globs": [
      "**/*"
    ],
    "regex": "(?i)\\b(TODO|FIXME)\\b",
    "description": "TODO/FIXME indicates incomplete work or known debt.",
    "recommendation": "Convert into tracked issues with owners and deadlines; remove once addressed.",
    "cwe": null,
    "owasp": null
  }
]
